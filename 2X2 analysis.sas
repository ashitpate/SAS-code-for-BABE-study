
data PK_data;
 input Sub_id $ Sequence $ Formulation $ Period Cmax AUC;
    datalines;
1001 RT R 1 1466.174 55577.08
1001 RT T 2 1590.014 57506.381
1002 TR T 1 1829.327 57962.568
1002 TR R 2 2349.051 63732.551
1003 TR T 1 1544.022 54213.355
1003 TR R 2 1800.901 63617.47
1004 RT R 1 2098.764 55456.898
1004 RT T 2 2184.476 60517.372
1005 RT R 1 2131.781 75534.709
1005 RT T 2 2285.12 73506.739
1006 TR T 1 1963.133 68302.998
1006 TR R 2 2359.691 70615.507
1007 TR T 1 2898.858 103644.795
1007 TR R 2 3592.713 116583.326
1008 RT R 1 3374.857 83682.975
1008 RT T 2 2639.479 82273.43
1009 RT R 1 1741.052 63254.84
1009 RT T 2 2023.088 72343.043
1010 TR T 1 2957.318 76395.879
1010 TR R 2 2849.392 73329.919
1011 TR T 1 1683.358 55752.848
1011 TR R 2 2900.991 66660.092
1012 RT R 1 2857.388 73010.202
1012 RT T 2 2152.239 75701.472
1013 TR T 1 1858.09 59201.084
1013 TR R 2 2585.516 64298.052
1014 RT R 1 3064.478 107361.143
1014 RT T 2 2871.607 107763.733
1015 TR T 1 1501.142 67618.906
1015 TR R 2 2663.775 85469.551
1016 RT R 1 2655.084 71274.697
1016 RT T 2 2047.586 74830.55
1017 TR T 1 1959.963 54956.271
1017 TR R 2 2268.167 62214.334
1018 RT R 1 2160.116 54922.14
1018 RT T 2 1873.78 59959.525
1019 TR T 1 1766.004 59556.279
1019 TR R 2 2203.851 66183.846
1020 RT R 1 2709.608 83728.141
1020 RT T 2 1989.955 90356.252
1021 RT R 1 1697.516 58765.82
1021 RT T 2 1639.004 60443.372
1022 TR T 1 2604.838 69149.879
1022 TR R 2 2691.934 81209.032
1023 RT R 1 2704.49 75862.279
1023 RT T 2 2504.384 87543.441
1024 TR T 1 1868.43 53898.133
1024 TR R 2 2896.73 59330.141
1026 RT R 1 2327.617 65898.946
1026 RT T 2 2191.084 74430.069
1027 RT R 1 1511.116 55160.77
1027 RT T 2 1823.51 66220.676
1028 TR T 1 1533.318 46389.476
1028 TR R 2 1924.583 51880.303
1029 RT R 1 2488.417 61689.775
1029 RT T 2 2347.549 66003.308
1030 TR T 1 2098.259 78603.49
1030 TR R 2 2620.321 94254.198
1031 RT R 1 2226.326 69927.568
1031 RT T 2 2447.903 72333.883
1032 TR T 1 1845.156 62639.394
1032 TR R 2 2338.183 64152.214
1033 TR T 1 2523.119 68639.295
1033 TR R 2 2464.705 71424.32
1034 RT R 1 2140.431 53433.087
1034 RT T 2 2073.544 60115.4
1035 TR T 1 2726.571 98222.14
1035 TR R 2 2347.369 109874.623
1036 RT R 1 2231.645 83774.503
1036 RT T 2 2317.006 88828.473
1037 RT R 1 3146.806 94142.439
1037 RT T 2 2802.375 94773.498
1038 TR T 1 1978.303 69454.756
1038 TR R 2 2071.094 72874.009
1039 RT R 1 1852.145 47913.304
1039 RT T 2 1281.827 48208.639
1040 TR T 1 1794.34 55271.455
1040 TR R 2 1856.209 61663.738
1041 TR T 1 1547.906 43204.073
1041 TR R 2 1980.748 43301.525
1042 RT R 1 1752.846 63342.23
1042 RT T 2 2498.637 74551.939
1043 RT R 1 3378.991 85505.704
1043 RT T 2 2414.578 68893.98
1046 TR T 1 2056.815 54595.303
1046 TR R 2 1795.128 52336.261
1047 TR T 1 1769.165 75791.347
1047 TR R 2 2301.198 73634.624
1048 RT R 1 1781.845 56369.739
1048 RT T 2 1934.34 55473.715
1049 TR T 1 2379.568 70523.592
1049 TR R 2 2954.725 79345.076
1050 RT R 1 3328.983 91301.142
1050 RT T 2 3307.549 103648.397
1051 RT R 1 2016.664 83377.375
1051 RT T 2 2269.271 89846.052
1052 TR T 1 1915.63 59142.544
1052 TR R 2 1026.556 46034.867
1053 TR T 1 1681.189 58805.333
1053 TR R 2 2234.095 64542.875
1054 RT R 1 2755.152 68204.17
1054 RT T 2 2367.396 74317.634
1055 TR T 1 1873.561 68551.958
1055 TR R 2 1974.283 72266.997
1056 RT R 1 2998.943 83914.423
1056 RT T 2 2010.459 88173.653
1057 RT R 1 1877.23 53211.87
1057 RT T 2 1971.509 61987.223
1058 TR T 1 2766.829 76095.214
1058 TR R 2 2326.508 81965.423
1059 RT R 1 2045.873 86620.764
1059 RT T 2 2654.819 88378.9
1060 TR T 1 2299.728 72533.32
1060 TR R 2 2293.856 81073.862
1061 TR T 1 2166.072 66466.973
1061 TR R 2 2537.307 71160.726
1062 RT R 1 2669.955 80487.527
1062 RT T 2 2249.999 83468.561
1063 TR T 1 2173.253 87803.152
1063 TR R 2 2560.818 108475.259
1064 RT R 1 2933.404 84481.615
1064 RT T 2 2591.786 98761.394
1065 TR T 1 1585.013 50339.289
1065 TR R 2 2063.175 56743.159
1066 RT R 1 3711.662 94925.035
1066 RT T 2 2692.806 99497.925
1067 TR T 1 2451.676 82402.619
1067 TR R 2 2333.274 83472.603
1069 RT R 1 3165.247 96705.373
1069 RT T 2 2753.462 93930.751
1070 TR T 1 1945.515 70996.984
1070 TR R 2 1636.901 80471.516
2044 TR T 1 2291.414 64788.241
2044 TR R 2 2569.7 72621.786
;
run;
ods graphics off;

data PK_data;
    set PK_data;
    lnCmax = log(Cmax);
    lnAUC  = log(AUC);
run;

 ods output OverallANOVA= aov_Cmax;
proc glm data=PK_data;
    class Sub_id Sequence Period Formulation;
    model lnCmax =
          Sequence
          Sub_id(Sequence)
          Period
          Formulation;
    lsmeans Formulation / pdiff=control('R') cl alpha=0.10;
    title "Bioequivalence Analysis – Cmax"; 
run;
quit;

ods output OverallANOVA= aov_AUC;
proc glm data=PK_data;
    class Sub_id Sequence Period Formulation;
    model lnAUC =
          Sequence
          Sub_id(Sequence)
          Period
          Formulation;
    lsmeans Formulation / pdiff=control('R') cl alpha=0.10;
    title "Bioequivalence Analysis – AUC";
run;
quit;

data CV_Cmax;
    set aov_Cmax;
    if Source = "Error" then do;
        MSE = MS;
        CV_percent = sqrt(exp(MSE) - 1) * 100;
    end;
run;

data CV_Cmax_clean;
    set CV_Cmax;
    if not missing(MSE);  
run;

proc print data=CV_Cmax_clean noobs;
    var MSE CV_percent;
    title "INTRA-SUBJECT VARIABILITY OF Cmax";
run;

data CV_AUC;
    set aov_auc;
    if Source = "Error" then do;
        MSE = MS;
        CV_percent = sqrt(exp(MSE) - 1) * 100;
    end;
run;

data CV_AUC_clean;
    set CV_AUC;
    if not missing(MSE);  
run;

proc print data=CV_AUC_clean noobs;
    var MSE CV_percent;
    title "INTRA-SUBJECT VARIABILITY OF AUC";
run;




